{% extends "base.html" %}
{% block title %}网络分析{% endblock %}
{% block module_title %}深度分析{% endblock %}

{% block head_css %}
    <!-- 走势图切换按钮css -->
    <link rel="stylesheet" href="/static/bootstrap-switch/_dist/css/bootstrap3/bootstrap-switch.min.css">

    <style type="text/css">
        #trend_div {
            height: 270px;
            width: 100%;
            float: left;
            border: 1px solid #F0F0F0;
            background: #F0F0F0;
        }

        #trend_div1 {
            height: 270px;
            width: 100%;
            float: left;
            border: 1px solid #F0F0F0;
            background: #F0F0F0;
        }

        .blkUnit {
            position: relative;
            clear: both;
            margin-top: 5px;
            background-color: #fff;
        }
        .blkUnit .titlBar {
            z-index: 4;
            position: relative;
            height: 16px;
            padding: 5px;
            background-color: #f6f6f6;
        }
        .titlBar h4 {
            display: inline-block;
            margin-top: -5px;
            padding-right: 0px;
            font-size: 15px;
            color: #666;
        }
        .titlBar .compInfo {
            padding-right: 15px;
            color: #858585;
        }
        .stmTabs{
            padding: 20px;
        }
        .stmTabs .tabTitle {
            height: 22px;
            margin-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        .stmTabs .tabLi .nmTab, .stmTabs .tabLi .hvTab {
            max-width: 110px;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }
        .stmTabs .tabLi .nmTab, .stmTabs .tabLi .hvTab {
            height: 23px;
            padding: 0 14px;
            _float: left;
        }
        .stmTabs .tabLi {
            display: block;
            float: left;
            text-decoration: none;
            color: #666;
        }
        .stmTabs .tabLi .hvTab {
            display: none;
            color: #6e87d7;
            height: 21px;
            border-bottom: 2px solid #6e87d7;
        }
        .sigma-expand {
            position: relative;
            margin: 0px auto;
            height: 500px;
            width: 500px;
        }
        .label-important, .badge-important {
            background-color: #b94a48;
        }
        .mainSplit {
            top: 64px;
            position: relative;
            _overflow: visible;
            padding: 0px 26px 20px 15px;
            border-left: 2px solid #e1e1e1;
        }
        .icon-ok {
            background-position: -312px 0;
        }
        .icon-ok{
            display: inline-block;
            width: 14px;
            height: 14px;
            margin-top: 1px;
            line-height: 14px;
            vertical-align: text-top;
            background-image: url("/static/bootstrap/img/glyphicons-halflings.png");
            background-position: 14px 14px;
            background-repeat: no-repeat;
        }
        .pagination ul {
            display: inline-block;
            margin-bottom: 0;
            margin-left: 0;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
            border-radius: 4px;
            -webkit-box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            -moz-box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .pagination-centered {
            text-align: center;
        }
        .pagination {
            margin: 20px 0;
        }
        .pagination ul>li>a, .pagination ul>li>span {
            float: left;
            padding: 4px 12px;
            line-height: 20px;
            text-decoration: none;
            background-color: #fff;
            border: 1px solid #ddd;
            border-left-width: 0;
        }
        .pagination ul>li {
            display: inline;
        }
        .lrRadius {
            display: inline-block;
            width: 184px;
            height: 20px;
            margin: 0 6px;
            text-align: right;
            font-weight: normal;
        }
        .lrRadius .lrRl {
            float: left;
            margin-left: -6px;
            background-position: -100px -180px;
        }
        .lrRadius .lrRl, .lrRadius .lrRr {
            top: 0;
            width: 6px;
            height: 20px;
            background-image: url(../imgs/icons.png?0508);
        }
        .lrRadius .lrRc {
            float: left;
            width: 230px;
            height: 18px;
            padding-top: 2px;
            background-color: #e2e2e2;
            text-align: left;
        }
        .lrRadius .lrRb {
            float: left;
            width: 200px;
            height: 18px;
            padding-top: 2px;
            background-color: #e2e2e2;
            text-align: left;
        }
        td, th {
            display: table-cell;
            vertical-align: inherit;
            padding-left: 80px;
        }
        th {
            font-weight: bold;
        }
        #lTools {
            height: 600px;
        }
        .node-info-popup ul li a:link {
            color: #000000;
        }
        .node-info-popup ul li a:hover {
            color: #00FFFF;
        }
        #control-pane-left {
            top: 59px;
            left: 2px;
            position: absolute;
            width: 230px;
            background-color: rgb(249, 247, 237);
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        #control-pane-left > div {
            margin: 10px;
            overflow-x: auto;
        }
        #control-pane-left a:hover{
            color: #428bca;
        }
        #control-pane {
            top: 59px;
            right: 2px;
            position: absolute;
            width: 230px;
            background-color: rgb(249, 247, 237);
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        #control-pane > div {
            margin: 10px;
            overflow-x: auto;
        }
        #control-pane-rightdown {
            top: 276px;
            right: 2px;
            position: absolute;
            width: 230px;
            background-color: rgb(249, 247, 237);
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        #control-pane-rightdown a:hover{
            color: #428bca;
        }
        #control-pane-rightdown > div {
            margin: 10px;
            overflow-x: auto;
        }
        .line {
            clear: both;
            display: block;
            width: 100%;
            margin: 0;
            padding: 12px 0 0 0;
            border-bottom: 1px solid #aac789;
            background: transparent;
        }
        .underline {
            color: #437356;
            background: #f4f0e4;
            margin: 0;
            border-radius: 2px;
            padding: 8px 12px;
            font-weight: 700;
        }
        .hidden {
            display: none;
            visibility: hidden;
        }
        #control-pane input[type=range] {
            width: 130px;
            display: inline;
        }

    </style>
{% endblock head_css %}

{% block head_js %}
    <script src="/static/js/highstock.js"></script>
    <script src="/static/js/exporting.js"></script>
    <script src="/static/js/echarts-2.0.1/_build/echarts-plain.js" type="text/javascript"></script>
    <!--
    <script src="/static/js/identify/sigma.min.js"></script>
    <script src="/static/js/identify/sigma.parseGexf.js"></script>
    -->
    <!-- START SIGMA IMPORTS -->
    <script src="/static/sigma.js/src/sigma.core.js"></script>
    <script src="/static/sigma.js/src/conrad.js"></script>
    <script src="/static/sigma.js/src/utils/sigma.utils.js"></script>
    <script src="/static/sigma.js/src/utils/sigma.polyfills.js"></script>
    <script src="/static/sigma.js/src/sigma.settings.js"></script>
    <script src="/static/sigma.js/src/classes/sigma.classes.dispatcher.js"></script>
    <script src="/static/sigma.js/src/classes/sigma.classes.configurable.js"></script>
    <script src="/static/sigma.js/src/classes/sigma.classes.graph.js"></script>
    <script src="/static/sigma.js/src/classes/sigma.classes.camera.js"></script>
    <script src="/static/sigma.js/src/classes/sigma.classes.quad.js"></script>
    <script src="/static/sigma.js/src/captors/sigma.captors.mouse.js"></script>
    <script src="/static/sigma.js/src/captors/sigma.captors.touch.js"></script>
    <script src="/static/sigma.js/src/renderers/sigma.renderers.canvas.js"></script>
    <script src="/static/sigma.js/src/renderers/sigma.renderers.webgl.js"></script>
    <script src="/static/sigma.js/src/renderers/sigma.renderers.def.js"></script>
    <script src="/static/sigma.js/src/renderers/webgl/sigma.webgl.nodes.def.js"></script>
    <script src="/static/sigma.js/src/renderers/webgl/sigma.webgl.nodes.fast.js"></script>
    <script src="/static/sigma.js/src/renderers/webgl/sigma.webgl.edges.def.js"></script>
    <script src="/static/sigma.js/src/renderers/webgl/sigma.webgl.edges.fast.js"></script>
    <script src="/static/sigma.js/src/renderers/webgl/sigma.webgl.edges.arrow.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.labels.def.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.hovers.def.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.nodes.def.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.edges.def.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.edges.curve.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.edges.arrow.js"></script>
    <script src="/static/sigma.js/src/renderers/canvas/sigma.canvas.edges.curvedArrow.js"></script>
    <script src="/static/sigma.js/src/middlewares/sigma.middlewares.rescale.js"></script>
    <script src="/static/sigma.js/src/middlewares/sigma.middlewares.copy.js"></script>
    <script src="/static/sigma.js/src/misc/sigma.misc.animation.js"></script>
    <script src="/static/sigma.js/src/misc/sigma.misc.bindEvents.js"></script>
    <script src="/static/sigma.js/src/misc/sigma.misc.drawHovers.js"></script>
    <script src="/static/sigma.js/plugins/sigma.parsers.gexf/gexf-parser.js"></script>
    <script src="/static/sigma.js/plugins/sigma.parsers.gexf/sigma.parsers.gexf.js"></script>
    <script src="/static/sigma.js/plugins/sigma.plugins.neighborhoods/sigma.plugins.neighborhoods.js"></script>
    <script src="/static/sigma.js/plugins/sigma.plugins.filter/sigma.plugins.filter.js"></script>
    <script src="/static/sigma.js/plugins/sigma.layout.forceAtlas2/worker.js"></script>
    <script src="/static/sigma.js/plugins/sigma.layout.forceAtlas2/supervisor.js"></script>
    <!-- END SIGMA IMPORTS -->

    <script src="/static/js/identify/jquery.bootpag.js"></script> 
    <script src="/static/js/identify/topic_identify.js"></script>
{% endblock head_js %}

{% block content %}
    <div class="blkUnit grpUnit" id="trendProfile">
        <div class="titlBar" style="padding-bottom:15px;">
            <h4 style="margin-left:15px"><b>网络概况</b></h4>
        <i id="summary_tooltip" class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="right" title="网络概况"></i>&nbsp;&nbsp;
        </div>
        <div class="tabUnit" style="height:220px">
            <div class="tabConts"></div>
            <h5 style="padding-left:30px;padding-top:5px"><b>有向图</b></h5>
            <table class="mtable" id="mstable">
            </table>
        <h5 style="margin-left:30px"><b>无向图</b></h5>

        <table class="mtable" id="mstable1">

        </table>
        <h5 style="margin-left:30px"><b>无向图-最大连通子图</b></h5>

        <table class="mtable" id="mstable2">

        </table>
        </div>
    </div>

    <div class="blkUnit grpUnit" id="trendProfile" style="margin-top:20px">
         
                    <button class="btn btn-primary btn-xs" style="margin-left:18px"
                    onclick='drawpicture()'>最短路径长度曲线</button>
                    <button class="btn btn-primary btn-xs" onclick='drawpicture_ln()'>节点出入度分布曲线</button>
         
        <div class="tabUnit">
            <div class="tabTitle" style="padding-top:1px;background-color:#f6f6f6;" id="auto_gsid_3">
            </div>
            <div class="tabConts">
                <div id="line" style="height:300px"></div>
            </div>
        </div>
    </div>

    <div class="well" style="width:1033px;margin-top:25px">
        <div class="titlBar" style="padding-bottom:15px;">
            <h4><b>关键用户</b></h4>
        <i id="keyclient_tooltip" class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="right" title="关键用户"></i>&nbsp;&nbsp;
        </div>
        <div style="height:50px">
            
                    <button class="btn btn-primary btn-xs" onclick='get_pagerank()'>pagerank排名</button>
                    <button class="btn btn-primary btn-xs" onclick='get_centrelity()'>度中心性排名</button>
                    <button class="btn btn-primary btn-xs" onclick='betweeness_centrality_rank()'>介数排名</button>
                    <button class="btn btn-primary btn-xs" onclick='closeness_centrality_rank()'>紧密中心性排名</button>
            
            <label>
                <div id="current_process" class="progress progress-striped active"></div>
            </label>
        </div>
        <!--
        <div>
            <p>
                <a class="btn btn-small btn-success" href="#" id="out">
                    <i class="icon-download-alt"></i> 导出
                </a>
                <a id="add_kd" class="btn btn-small btn-info" href="#" title="将勾选的人加入知识库">
                    <i class="icon-file"></i> 加入知识库
                </a>
                <a id="remove_kd" class="btn btn-small btn-info" href="#" title="将勾选的人移出知识库">
                    <i class="icon-file"></i> 移出知识库
                </a>
                <a id="add_trash" class="btn btn-small btn-danger" href="#" title="将勾选的人加入垃圾名单">
                    <i class="icon-ban-circle"></i> 加入垃圾名单
                </a>
            </p>
        </div>
        -->
        <div id="rank_table">
            <table class="table table-bordered">
            </table>
        </div>
        <div id="rank_page_selection" class="pagination-centered" style="margin-top:5px"></div>
    </div>
    <div class="well" style="width:1033px">
        <div class="titlBar" style="padding-bottom:15px;">
            <h4><b>网络呈现</b></h4>
        <i id="display_tooltip" class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="rig" title="网络呈现"></i>&nbsp;&nbsp;
        </div>
        <form class="form-inline">
            <img class="img-polaroid">
            <!--<label><input type="checkbox" checked="true"> 动画演示 </label> -->
            <a1 href="javascript:void(0);" onclick="show_network();" class="btn btn-primary btn-xs"><i class="icon-picture"></i><h5>生成并查看网络</h5></a1>
            <a2 href="javascript:void(0);" onclick="download();" class="btn btn-primary btn-xs" ><i class="icon-picture"></i><h5>下载图片</h5></a2>
        </form>

        <div id="network" class="collapse out" style="position: relative;">
            <div id="loading_network_data" class="alert alert-info">
            系统繁忙计算中，请稍后...
            </div>
            <label>
                <div id="network_progress" class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div>
            </label>
            <div class="sigma-expand" id="sigma-graph"></div>
            <div id="control-pane-left">
                <h3 class="underline">布局控制器</h3>
                <div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--linLogMode-->对数模式
                        <label>
                            <input type="radio" name="linLogModeRadios" value="true" checked>
                                是
                        </label>
                        <label>
                            <input type="radio" name="linLogModeRadios" value="false">
                                否
                        </label>
                        <input id="linLogModeInput" value="true" type="hidden">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--outboundAttractionDistribution-->离心力分布模式
                        <label>
                            <input type="radio" name="outboundAttractionRadios" value="true" checked>
                                是
                        </label>
                        <label>
                            <input type="radio" name="outboundAttractionRadios" value="false">
                                否
                        </label>
                        <input id="outboundAttractionInput" value="true" type="hidden">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--adjustSizes-->调整尺寸模式
                        <label>
                            <input type="radio" name="adjustSizesRadios" value="true" checked>
                                是
                        </label>
                        <label>
                            <input type="radio" name="adjustSizesRadios" value="false">
                                否
                        </label>
                        <input id="adjustSizesInput" value="true" type="hidden">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--strongGravityMode-->强引力模式
                        <label>
                            <input type="radio" name="strongGravityModeRadios" value="true" checked>
                                是
                        </label>
                        <label>
                            <input type="radio" name="strongGravityModeRadios" value="false">
                                否
                        </label>
                        <input id="strongGravityModeInput" value="true" type="hidden">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--edgeWeightInfluence-->边权重影响&nbsp;&nbsp;<span id="edgeWeightInfluence_span">1</span><input id="edgeWeightInfluence_input" type="range" min="0" value="1" onclick="change_edgeWeightInfluence();">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--scalingRatio-->缩放比例&nbsp;&nbsp;<span id="scalingRatio_span">1</span><input id="scalingRatio_input" type="range" min="0" value="1" onclick="change_scalingRatio();">
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--gravity-->引力&nbsp;&nbsp;<span id="gravity_span">10</span><input id="gravity_input" type="range" min="0" value="10" onclick="change_gravity();"> 
                    </div>
                    <div style="margin: 2px auto 10px 0px;font-size: 13px;">
                        <!--slowdown-->收敛速度&nbsp;&nbsp;<span id="slowdown_span">2</span><input id="slowdown_input" type="range" min="0" value="2" onclick="change_slowdown();"> 
                    </div>
                </div>
                <span class="line"></span>
                <span>
                    <a id="refresh_layout" class="button button-rounded button-flat-primary"><i class="glyphicon glyphicon-refresh icons"></i>刷新布局</a>
                    <a id="pause_layout" class="button button-rounded button-flat-primary"><i class="glyphicon glyphicon-pause icons"></i>暂停布局</a>
                    <a id="stop_layout" class="button button-rounded button-flat-primary"><i class="glyphicon glyphicon-stop icons"></i>停止布局</a>
                </span>
            </div>
            <div id="control-pane">
                <h3 class="underline">过滤器</h3>
                <div>
                    指标类别
                    <select id="zhibiao-category">
                        <option value="degree" selected>度</option>
                        <option value="pagerank">Pagerank</option>
                    </select>
                </div>
                <div id="min_degree_container">
                  最小度&nbsp;&nbsp;<span id="min-degree-val">0</span><br>
                  <input id="min-degree" type="range" min="0" value="0"> <span id="max-degree-value">0</span>
                </div>
                <div id="min_pagerank_container" class="hidden">
                  最小Pagerank&nbsp;&nbsp;<span id="min-pagerank-val">0</span>e-8<br>
                  <input id="min-pagerank" type="range" min="0" value="0"> <span id="max-pagerank-value">0</span>e-8
                </div>
                <div>
                  节点类别
                  <select id="node-category">
                    <option value="" selected>所有类别</option>
                  </select>
                </div>
                <span class="line"></span>
                <div>
                  <button id="reset-btn">重置过滤器</button>
                </div>
            </div>
            <div id="control-pane-rightdown">
                <h3 class="underline">节点信息</h3>
                <div>
                用户昵称: <span id="nickname"></span>
                </div>
                <div>
                用户所在地: <span id="location"></span>
                </div>
                <div>
                用户微博链接: <span id="user_link"></span>
                </div>
                <div>
                用户Pagerank值: <span id="pagerank"></span>
                </div>
                <div>
                用户所属社区: <span id="community"></span>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}
<% block tail_js %>
    <script>      
        $("#summary_tooltip").tooltip();
        $("#keyclient_tooltip").tooltip();
        $("#display_tooltip").tooltip();
        $("#frequency_tooltip").tooltip();
        $("#power_law_distribution_tooltip").tooltip();
    </script>
<% endblock tail_js %>
